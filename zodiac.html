<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zodiac Sign Info</title>
    <link rel="stylesheet" href="/public/style.css" />
    <link rel="icon" href="/public/favicon.ico" />
</head>
<body>
    <div id="zodiac-info-container">
        <h1 id="zodiac-sign"></h1>
        <h3>Lucky Number: <span id="lucky-number"></span></h3>
        <h3>Element: <span id="element"></span></h3>
        <h3>Sign Type: <span id="sign-type"></span></h3>
        <h3>Ruling Planets:</h3>
        <ul>
            <li>Modern: <span id="modern-planet"></span></li>
            <li>Traditional: <span id="traditional-planet"></span></li>
        </ul>
        <h3>Planet Traits:</h3>
        <ul id="planet-traits-list">
            <!-- Planet traits will be added here -->
        </ul>
        <h3>Traits:</h3>
        <ul id="traits-list">
            <!-- Traits will be added here -->
        </ul>
        <button onclick="handleLogout()">Logout</button>
    </div>

    <!-- New Form for User Data Input -->
    <div id="user-info-form">
        <h2>Enter Your Information</h2>
        <form id="userForm">
            <label for="name">Name:</label>
            <input type="text" id="name" name="name" required><br>

            <label for="dob">Date of Birth:</label>
            <input type="date" id="dob" name="dob" required><br>

            <label for="gender">Gender:</label>
            <select id="gender" name="gender">
                <option value="male">Male</option>
                <option value="female">Female</option>
                <option value="other">Other</option>
            </select><br>

            <button type="submit">Submit</button>
        </form>
    </div>

    <script type="module">
        import { handleLogout } from '/public/signup.js';
        
        // Get user data (This is a placeholder. Replace with actual logic to retrieve user data)
        const userZodiacData = JSON.parse(localStorage.getItem('userZodiacData')) || {};

        // Populate the zodiac info
        document.getElementById('zodiac-sign').textContent = userZodiacData.zodiacSign || 'Unknown';
        document.getElementById('lucky-number').textContent = userZodiacData.luckyNumber || 'Unknown';
        document.getElementById('element').textContent = userZodiacData.element || 'Unknown';
        document.getElementById('sign-type').textContent = userZodiacData.signType || 'Unknown';
        document.getElementById('modern-planet').textContent = userZodiacData.modernPlanet || 'Unknown';
        document.getElementById('traditional-planet').textContent = userZodiacData.traditionalPlanet || 'Unknown';

        // Populate planet traits
        const planetTraitsList = document.getElementById('planet-traits-list');
        for (const planet in userZodiacData.planetTraits) {
            const traitItem = document.createElement('li');
            traitItem.textContent = `${planet}: ${userZodiacData.planetTraits[planet].join(', ')}`;
            planetTraitsList.appendChild(traitItem);
        }

        // Populate traits
        const traitsList = document.getElementById('traits-list');
        userZodiacData.traits.forEach(trait => {
            const traitItem = document.createElement('li');
            traitItem.textContent = trait;
            traitsList.appendChild(traitItem);
        });

        // Function to handle logout
        function handleLogout() {
            localStorage.removeItem('userZodiacData'); // Clear stored data
            window.location.href = '/'; // Redirect to the login/signup page
        }

        // Handle form submission to send the data to the backend
        document.getElementById('userForm').addEventListener('submit', function(event) {
            event.preventDefault();
            const formData = {
                name: document.getElementById('name').value,
                dob: document.getElementById('dob').value,
                gender: document.getElementById('gender').value,
            };
            fetch('/submit-form', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(formData),
            })
            .then(response => response.json())
            .then(data => {
                alert('Form submitted successfully!');
            })
            .catch(error => {
                console.error('Error:', error);
            });
        });
    </script>
</body>
</html>
